# План разработки админ-панели "Fizio" на Filament

Этот документ описывает все задачи по созданию и улучшению админ-панели.

## Фаза 1: Базовая настройка и управление пользователями

На этом этапе мы создадим основу админки и добавим самую важную её часть — управление пользователями.

- [x] **Задача 1.1: Создать `UserResource`**
    - [x] Сгенерировать ресурс командой `php artisan make:filament-resource User --generate`.
    - [x] Настроить колонки в таблице: `ID`, `Аватар`, `Имя`, `Email`, `Дата регистрации`.
    - [x] Настроить поля в форме создания/редактирования:
        - `Имя` (текстовое поле).
        - `Email` (поле для email).
        - `Пароль` (с подтверждением, виден только при создании).
        - `Аватар` (поле для загрузки изображений).
    - [x] Добавить глобальный поиск по полям `name` и `email`.
    - [x] Добавить фильтр по "Email подтвержден".

- [x] **Задача 1.2: Создать главный дашборд с виджетами**
    - [x] Создать виджет `StatsOverviewWidget` для отображения ключевых метрик.
        - [x] Метрика: Общее количество пользователей.
        - [x] Метрика: Количество тренировок за сегодня.
        - [x] Метрика: Количество приемов пищи за сегодня.
    - [x] Создать виджет `ChartWidget` для визуализации данных.
        - [x] График: Динамика регистрации новых пользователей за последние 14 дней.

## Фаза 2: Управление ключевыми данными приложения

На этом этапе мы добавим возможность управлять основными сущностями вашего приложения: тренировками, питанием и чатами.

- [x] **Задача 2.1: Создать `WorkoutResource`**
    - [x] Сгенерировать ресурс.
    - [x] Настроить таблицу: `ID`, `Пользователь`, `Дата`, `Тип тренировки`, `Сожжено калорий`.
    - [x] Настроить форму: выбор пользователя (`BelongsTo`), выбор даты, текстовые поля для описания.
    - [x] Добавить фильтры по пользователю и по дате.

- [x] **Задача 2.2: Создать `MealResource`**
    - [x] Сгенерировать ресурс.
    - [x] Настроить таблицу: `ID`, `Пользователь`, `Дата`, `Тип` (завтрак, обед и т.д.), `Калории`.
    - [x] Настроить форму: выбор пользователя, выбор типа приема пищи. Для поля `items` (которое является JSON) использовать `KeyValue`.
    - [x] Добавить фильтры по пользователю, дате и типу приема пищи.

- [x] **Задача 2.3: Создать `ChatMessageResource` (в режиме "только чтение")**
    - [x] Сгенерировать ресурс.
    - [x] Настроить таблицу: `Пользователь`, `Сообщение` (сокращенное), `Отправитель` (user/bot), `Время отправки`.
    - [x] Отключить возможность создания, редактирования и удаления записей из админки. Этот ресурс нужен только для просмотра.

## Фаза 3: Продвинутые возможности и безопасность

На этом этапе мы добавим роли, разрешения и инструменты для мониторинга, чтобы сделать админку безопасной и удобной для обслуживания.

- [x] **Задача 3.1: Внедрить роли и разрешения**
    - [x] Установить `spatie/laravel-permission`.
    - [x] Установить плагин `filament/spatie-laravel-permission-plugin`.
    - [x] Добавить трейт `HasRoles` в модель `User`.
    - [x] Создать роли "Admin" и "User".
    - [x] Обновить метод `canAccessPanel` в модели `User`, чтобы доступ в админку был только у пользователей с ролью "Admin".
    - [x] Назначить роль "Admin" вашему текущему пользователю через `php artisan tinker`.

- [x] **Задача 3.2: Добавить инструменты мониторинга**
    - [x] Установить и настроить `bezhanov/filament-log-viewer` для просмотра логов ошибок.
    - [x] (Опционально) Установить и настроить `roman-ti/filament-queue-monitor` для мониторинга очередей.

- [x] **Задача 3.3: Создать страницу настроек**
    - [x] Установить `rawilk/filament-settings`.
    - [x] Создать страницу настроек для управления API ключами (`SPOONACULAR_API_KEY`, `FATSECRET_CLIENT_ID` и т.д.) и другими глобальными параметрами, чтобы не редактировать `.env` файл вручную. 