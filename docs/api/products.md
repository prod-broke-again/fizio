# API Продуктов

В этом документе описаны доступные API для работы с продуктами питания. Мы интегрировали три различных API для предоставления наиболее полной информации о продуктах.

## FatSecret API

### Поиск продуктов
```http
GET /api/fatsecret/foods/search
```

#### Параметры запроса
| Параметр | Тип | Обязательный | Описание |
|----------|-----|--------------|-----------|
| query | string | Да | Поисковый запрос (минимум 2 символа) |
| page | integer | Нет | Номер страницы (по умолчанию: 1) |
| per_page | integer | Нет | Количество результатов на странице (по умолчанию: 20, максимум: 50) |

#### Пример ответа
```json
{
    "products": [
        {
            "food_id": "12345",
            "food_name": "Яблоко",
            "food_type": "Generic",
            "food_url": "https://..."
        }
    ],
    "total": 100
}
```

### Получение информации о продукте
```http
GET /api/fatsecret/foods/{foodId}
```

#### Параметры пути
| Параметр | Тип | Описание |
|----------|-----|-----------|
| foodId | string | ID продукта |

## OpenFoodFacts API

### Поиск продуктов
```http
GET /api/openfoodfacts/products/search
```

#### Параметры запроса
| Параметр | Тип | Обязательный | Описание |
|----------|-----|--------------|-----------|
| query | string | Да | Поисковый запрос (минимум 2 символа) |
| page | integer | Нет | Номер страницы (по умолчанию: 1) |
| per_page | integer | Нет | Количество результатов на странице (по умолчанию: 20, максимум: 50) |

#### Пример ответа
```json
{
    "products": [
        {
            "code": "5901234123457",
            "product_name": "Яблоко",
            "brands": "Brand Name",
            "nutriments": {
                "energy-kcal_100g": 52,
                "proteins_100g": 0.3,
                "carbohydrates_100g": 13.8,
                "fat_100g": 0.2
            },
            "ingredients_text": "Яблоко",
            "allergens_tags": [],
            "nutriscore_grade": "a"
        }
    ],
    "total": 100
}
```

### Поиск по штрих-коду
```http
GET /api/openfoodfacts/products/barcode/{barcode}
```

#### Параметры пути
| Параметр | Тип | Описание |
|----------|-----|-----------|
| barcode | string | Штрих-код продукта |

#### Пример ответа
```json
{
    "code": "5901234123457",
    "product_name": "Яблоко",
    "brands": "Brand Name",
    "nutriments": {
        "energy-kcal_100g": 52,
        "proteins_100g": 0.3,
        "carbohydrates_100g": 13.8,
        "fat_100g": 0.2
    },
    "ingredients_text": "Яблоко",
    "allergens_tags": [],
    "nutriscore_grade": "a",
    "images": {
        "front": {
            "display": {
                "url": "https://..."
            }
        }
    }
}
```

## Spoonacular API

### Поиск продуктов
```http
GET /api/spoonacular/products/search
```

#### Параметры запроса
| Параметр | Тип | Обязательный | Описание |
|----------|-----|--------------|-----------|
| query | string | Да | Поисковый запрос (минимум 2 символа) |
| page | integer | Нет | Номер страницы (по умолчанию: 1) |
| per_page | integer | Нет | Количество результатов на странице (по умолчанию: 20, максимум: 50) |

### Поиск по UPC
```http
GET /api/spoonacular/products/upc/{upc}
```

#### Параметры пути
| Параметр | Тип | Описание |
|----------|-----|-----------|
| upc | string | UPC код продукта |

## Общие особенности

### Кэширование
- Результаты поиска кэшируются на 5 минут (300 секунд)
- Информация о продукте кэшируется на 24 часа (86400 секунд)

### Обработка ошибок
Все API возвращают ошибки в следующем формате:

```json
{
    "error": "Описание ошибки",
    "message": "Детальное сообщение об ошибке"
}
```

#### Коды ошибок
- 422: Ошибка валидации
- 500: Внутренняя ошибка сервера

### Ограничения
- Минимальная длина поискового запроса: 2 символа
- Максимальное количество результатов на страницу: 50
- Все API требуют авторизации (кроме публичных эндпоинтов)

## Рекомендации по использованию

1. **FatSecret API**
   - Лучше всего подходит для поиска базовых продуктов питания
   - Предоставляет подробную информацию о пищевой ценности
   - Имеет хорошую поддержку русского языка

2. **OpenFoodFacts API**
   - Отлично подходит для поиска упакованных продуктов
   - Имеет большую базу данных штрих-кодов
   - Предоставляет информацию о составе и аллергенах
   - Использует официальный PHP пакет для надежной работы
   - Поддерживает глобальный поиск по всем странам

3. **Spoonacular API**
   - Хорошо подходит для поиска рецептов и ингредиентов
   - Предоставляет информацию о пищевой ценности
   - Имеет расширенные возможности фильтрации

## Примеры использования

### Поиск продукта через все API
```javascript
// FatSecret
fetch('/api/fatsecret/foods/search?query=яблоко')

// OpenFoodFacts
fetch('/api/openfoodfacts/products/search?query=яблоко')

// Spoonacular
fetch('/api/spoonacular/products/search?query=яблоко')
```

### Получение информации о продукте
```javascript
// FatSecret
fetch('/api/fatsecret/foods/12345')

// OpenFoodFacts
fetch('/api/openfoodfacts/products/barcode/5901234123457')

// Spoonacular
fetch('/api/spoonacular/products/upc/5901234123457')
``` 